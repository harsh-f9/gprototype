# Project Context: FastAPI Prototype for Form-Based App

## Goal
Build a clean, production-ready FastAPI app with server-side rendering (Jinja2 templates) and simple form handling. Focus on shipping a working prototype quickly, then iterate.

## Stack
- **Backend**: FastAPI + Uvicorn
- **Templates**: Jinja2 (server-side rendering)
- **Forms**: HTML forms with POST handlers
- **Styling**: Minimal CSS (or Tailwind via CDN if needed)
- **No frontend framework** (no React/Vue/etc.)

## Code Style & Conventions

### Python
- Use **FastAPI dependency injection** patterns
- Follow **PEP 8** (enforced by Ruff + Black)
- Type hints everywhere (Pydantic models for validation)
- Async route handlers (`async def`) by default
- Keep routes in `app/routes/`, business logic in `app/services/`
- Use structured logging (not print statements)

### File Structure
project/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ init.py
â”‚   â”œâ”€â”€ main.py              # FastAPI app entry point
â”‚   â”œâ”€â”€ config.py            # Settings (use pydantic-settings)
â”‚   â”œâ”€â”€ models.py            # Pydantic models for validation
â”‚   â”œâ”€â”€ routes/              # Route handlers (blueprints)
â”‚   â”‚   â”œâ”€â”€ init.py
â”‚   â”‚   â””â”€â”€ forms.py
â”‚   â”œâ”€â”€ services/            # Business logic
â”‚   â”‚   â””â”€â”€ init.py
â”‚   â”œâ”€â”€ templates/           # Jinja2 templates
â”‚   â”‚   â”œâ”€â”€ base.html
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â””â”€â”€ static/              # CSS, JS, images
â”‚       â””â”€â”€ styles.css
â”œâ”€â”€ tests/
â”œâ”€â”€ .env
â”œâ”€â”€ .gitignore
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md

### Templates
- Use Jinja2 **template inheritance** (`{% extends "base.html" %}`)
- Include **CSRF protection** (use `starlette.middleware.sessions`)
- Keep templates simple and semantic (minimal inline styles)

### Forms
- Use native HTML `<form method="POST">`
- Parse with `Form(...)` from FastAPI
- Return `HTMLResponse` with rendered template (not JSON unless API endpoint)
- Flash messages via session for success/error feedback

## What to Avoid
- No overengineering (YAGNI principle)
- No premature optimization
- No frontend build tools (Vite/Webpack) unless explicitly requested
- No ORMs yet (add later if needed)
- No Docker/Kubernetes until we're ready to deploy

## Error Handling
- Use FastAPI's `HTTPException` for user-facing errors
- Log unexpected errors with context
- Show friendly error messages in templates (not stack traces)

## Testing (when we get there)
- Use `pytest` + `httpx` for route testing
- Test happy path + validation errors
- Keep tests fast (no external dependencies unless mocked)

## Tone
- **Practical, not academic**: Prefer working code over perfect architecture
- **Explain trade-offs**: If suggesting a pattern, briefly say why
- **Ship iteratively**: Get v1 working, then refactor
- **Assume I want clean code**: But don't gold-plate unnecessarily

## When Helping Me
1. If I ask for a feature, generate the **full working code** (not just snippets)
2. If there are multiple approaches, briefly mention them but pick one and implement it
3. If you need clarification, askâ€”but make reasonable assumptions if minor
4. Always show where the code goes (file paths)
5. If introducing a new dependency, mention it and add to requirements.txt

## Current Phase
ðŸš§ **Phase 1**: Set up basic FastAPI app with one working form (proof of concept)